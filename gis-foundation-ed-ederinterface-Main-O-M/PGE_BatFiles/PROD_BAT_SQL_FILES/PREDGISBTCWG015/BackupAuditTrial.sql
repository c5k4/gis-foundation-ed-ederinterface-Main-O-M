SET HEADING OFF;
WHENEVER SQLERROR EXIT SQL.SQLCODE

-- INSERT FROM EDER DATABASE

INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'EDER' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID FROM SYS.DBA_AUDIT_TRAIL@DBLINKEDER WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'EDER'));
COMMIT;
   

-- INSERT FROM EDERSUB DATABASE

INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'EDERSUB' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID FROM SYS.DBA_AUDIT_TRAIL@DBLINKEDERSUB WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'EDERSUB'));
COMMIT;
   
--INSERT FROM EDSCHM DATABASE

INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'EDSCHM' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID FROM SYS.DBA_AUDIT_TRAIL@DBLINKEDSCHM WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'EDSCHM'));
COMMIT;   



INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'EDWIPGMC' ,  OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID FROM SYS.DBA_AUDIT_TRAIL@DBLINKEDWIPGMC WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'EDWIPGMC'));
COMMIT;   

--INSERT FROM LBMAINT DATABASE 

INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'LBMAINT' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID FROM SYS.DBA_AUDIT_TRAIL@DBLINKLBMAINT WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'LBMAINT'));
COMMIT;

--INSERT FROM WIP DATABASE  

INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'WIP' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID FROM SYS.DBA_AUDIT_TRAIL@DBLINKWIP WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'WIP'));
COMMIT;
   
--INSERT FROM EDAUX DATABASE  

INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'EDAUX' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID   FROM SYS.DBA_AUDIT_TRAIL@DBLINKEDAUX WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'EDAUX'));
COMMIT;

-- ALL DC1 AND DC2 DATABASES
INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'EDGMC_A' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID   FROM SYS.DBA_AUDIT_TRAIL@DBLINKEDGMC_A WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'EDGMC_A'));
COMMIT;

INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'EDGMC_B' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID   FROM SYS.DBA_AUDIT_TRAIL@DBLINKEDGMC_B WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'EDGMC_B'));
COMMIT;

INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'EDSUBGMC_A' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID   FROM SYS.DBA_AUDIT_TRAIL@DBLINKEDSUBGMC_A WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'EDSUBGMC_A'));
COMMIT;

INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'EDSUBGMC_B' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID   FROM SYS.DBA_AUDIT_TRAIL@DBLINKEDSUBGMC_B WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'EDSUBGMC_B'));
COMMIT;

INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'LANDBASE_DC1_A' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID   FROM SYS.DBA_AUDIT_TRAIL@DBLINKLANDBASE_A1 WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'LANDBASE_DC1_A'));
COMMIT;

INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'LANDBASE_DC1_B' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID   FROM SYS.DBA_AUDIT_TRAIL@DBLINKLANDBASE_B1 WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'LANDBASE_DC1_B'));
COMMIT;


INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'EDPUB_DC1_A' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID   FROM SYS.DBA_AUDIT_TRAIL@DBLINKEDPUB_A1 WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'EDPUB_DC1_A'));
COMMIT;

INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'EDPUB_DC1_B' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID   FROM SYS.DBA_AUDIT_TRAIL@DBLINKEDPUB_B1 WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'EDPUB_DC1_B'));
COMMIT;



INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'EDSUBPUB_DC1_A' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID   FROM SYS.DBA_AUDIT_TRAIL@DBLINKEDSUBPUB_A1 WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'EDSUBPUB_DC1_A'));
COMMIT;

INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'EDSUBPUB_DC1_B' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID   FROM SYS.DBA_AUDIT_TRAIL@DBLINKEDSUBPUB_B1 WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'EDSUBPUB_DC1_B'));
COMMIT;




INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'EDSCHMPUB_DC1_A' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID   FROM SYS.DBA_AUDIT_TRAIL@DBLINKEDSCHMPUB_A1 WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'EDSCHMPUB_DC1_A'));
COMMIT;


INSERT INTO INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP
(SELECT 'EDSCHMPUB_DC1_B' , OS_USERNAME , USERNAME ,USERHOST ,TERMINAL ,  EXTENDED_TIMESTAMP, OWNER ,OBJ_NAME , ACTION , RETURNCODE , DBID   FROM SYS.DBA_AUDIT_TRAIL@DBLINKEDSCHMPUB_B1 WHERE RETURNCODE ='1017' AND EXTENDED_TIMESTAMP NOT IN (SELECT EXTENDED_TIMESTAMP FROM  INTDATAARCH.DBA_AUDIT_TRAIL_BACKUP WHERE DBNAME = 'EDSCHMPUB_DC1_B'));
COMMIT;

EXIT;

