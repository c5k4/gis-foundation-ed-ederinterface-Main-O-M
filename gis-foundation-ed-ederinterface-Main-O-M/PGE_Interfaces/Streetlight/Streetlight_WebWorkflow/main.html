<!DOCTYPE html>
<html>
<head>
    <title>Streetlight Workflow Management</title>
    <script type="text/javascript"> 
 //<![CDATA[
        function addClickEvents() {
            var countries = document.getElementById('svg1').childNodes;
            var i;
            for (i = 0; i < countries.length; i++) {
                countries[i].addEventListener('click', showCountry);
            }
        }

        function showCountry(e) {
            //         var node = e.target;
            //         if (node.id != 'ocean') {
            //             node = getCorrectNode(node);
            //         }
            alert(node.id);
        }

        function getCorrectNode(node) {
            if (node.id.length == 2 || node.id == 'lakes') {
                return node;
            }
            return getCorrectNode(node.parentNode);
        }
//]]> 
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <link href="styles/w3.css" rel="stylesheet" type="text/css" />
    <link href="styles/main.css" rel="stylesheet" type="text/css" />  
    <link href="css/dojo/flat.css" rel="stylesheet" type="text/css" />
    <link rel="Stylesheet" type="text/css" href="css/dgrid/css/dgrid.css" />
    <link href="css/dgrid/css/extensions/ColumnHider.css" rel="stylesheet" type="text/css" />
    <link href="css/dgrid/css/extensions/Pagination.css" rel="stylesheet" type="text/css" />
    <link href="css/dgrid/css/extensions/ColumnReorder.css" rel="stylesheet" type="text/css" />
    <link href="css/dgrid/css/extensions/ColumnResizer.css" rel="stylesheet" type="text/css" />
    <link href="css/dgrid/css/extensions/CompoundColumns.css" rel="stylesheet" type="text/css" />
    <link rel="Stylesheet" type="text/css" href="css/dgrid/css/skins/skin.css" />
    <?xml-stylesheet rel="stylesheet" type="text/css" href="styles/svg.css" ?>      
    <script src="jquery/jquery-3.1.1.min.js" type="text/javascript"></script>
    <script src="js/Config.js" type="text/javascript"></script>
   
</head>
<body>
    <table>
        <tr>
            <td>
                <img height="80" src="img/pge2.png" />
            </td>
            <td>
                <h2>
                    Streetlight Workflow Management</h2>
            </td>
        </tr>
    </table>
    <div id="pgeUser" style="float: right; margin-right: 10px;">
    </div>
    <hr />
    <div class="w3-container">
        <ul class="w3-navbar w3-black">
            <li><a href="javascript:void(0)" class="tablink w3-orange " onclick="openTab(event, 'DashBoard');">
                Assigned Task</a></li>
            <li><a href="javascript:void(0)" class="tablink" onclick="openTab(event, 'NewJob');">
               Initiate Job</a></li>
            <li><a href="javascript:void(0)" class="tablink" onclick="openTab(event, 'History');">
                Job History</a></li>
            <li><a href="javascript:void(0)" class="tablink" id="mainJobTab" style="display: none;">
             Job Process Flow</a></li>
                
        </ul>
        <div id="DashBoard" style="display: block" class="w3-container w3-border initTab">
         
        </div>
        <div id="NewJob" class="initTab">
           
            <div id="divNJWorkflow" class="w3-container w3-border">
                <div id="divWorkflow">
                    <article class="w3-container">
                <table style="width:100%; height:100%">
                    <tbody style="overflow-y: auto;">
                        <tr>
                            <!-- <td align="center">
                        <img src="img/upload.png" height="250" />
                        <hr />
                    </td>-->
                            <td align="center" colspan="2" style="height:300px;">
                               <!-- <fieldset style="height:300px; border-width:0px 0px 1px 0px">
                                    <legend></legend>-->
                                   <svg id="svg1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1290 400" preserveAspectRatio="xMidYMid meet " style ="margin-top:3%" width="100%" height="100%" xmlns:NS1="" NS1:xmlns:svg="http://www.w3.org/2000/svg">
    <defs>
        <marker id="arrowForward" markerWidth="10" markerHeight="10" refX="0" refY="3" orient="auto" markerUnits="strokeWidth" viewBox="0 0 20 20">
            <path d="M0,0 L0,6 L9,3 z" fill="#1689c5" />
        </marker>
        <marker id="arrowBack" markerWidth="10" markerHeight="10" refX="0" refY="3" orient="180deg" markerUnits="strokeWidth" viewBox="0 0 20 20">
            <path d="M0,0 L0,6 L9,3 z" fill="#1689c5" />
        </marker>

        <marker id="arrowUp" markerWidth="10" markerHeight="10" refX="0" refY="3" orient="270deg" markerUnits="strokeWidth" viewBox="0 0 20 20">
            <path d="M0,0 L0,6 L9,3 z" fill="#1689c5" />
        </marker>

        <marker id="arrowDown" markerWidth="10" markerHeight="10" refX="0" refY="3" orient="90" markerUnits="strokeWidth" viewBox="0 0 20 20">
            <path d="M0,0 L0,6 L9,3 z" fill="#1689c5" />
        </marker>

    </defs>

                                <!--Step_1-->
                              
                              <script type="text/ecmascript">
                                  function changerect(evt) {
                                      var svgobjId = evt;

                                      var rectNode = document.getElementById(svgobjId);                                     

                                      switch (TabClick) {
                                          case "Dashboard":
                                              if (parseFloat(svgobjId) <= parseFloat(CurrentTaskIDfrmDB)) {
                                                  displaySelWorkflowData(svgobjId, "WFStep");                                            
                                                  if (lastTaskId != '') {
                                                      var prevSelectedNode = document.getElementById(lastTaskId);
                                                      prevSelectedNode.setAttributeNS(null, "stroke", "");
                                                  }                                                
                                                  rectNode.setAttributeNS(null, "stroke", "#Fbbc05");
                                                  rectNode.setAttributeNS(null, "stroke-width", "4");
                                                  lastTaskId = svgobjId;
                                              }
                                              break;

                                          case "History":
                                              if (taskColorData.ACTIVETASK.length > 0) {
//                                                  if (parseInt(svgobjId) <= taskColorData.ACTIVETASK[0].REL_TASKID) {
                                                  if (parseFloat(svgobjId) <= parseFloat(CurrentTaskIDfrmDB)) {
                                                      displaySelWorkflowData(svgobjId, "WFStep"); //                                            
                                                      if (lastTaskId != '') {
                                                          var prevSelectedNode = document.getElementById(lastTaskId);
                                                          prevSelectedNode.setAttributeNS(null, "stroke", "");
                                                      }
                                                      rectNode.setAttributeNS(null, "stroke", "#Fbbc05");
                                                      rectNode.setAttributeNS(null, "stroke-width", "4");
                                                      lastTaskId = svgobjId;
                                                  }

                                              } else {
                                                  displaySelWorkflowData(svgobjId, "WFStep"); //                                            
                                                  if (lastTaskId != '') {
                                                      var prevSelectedNode = document.getElementById(lastTaskId);
                                                      prevSelectedNode.setAttributeNS(null, "stroke", "");
                                                  }
                                                  rectNode.setAttributeNS(null, "stroke", "#Fbbc05");
                                                  rectNode.setAttributeNS(null, "stroke-width", "4");
                                                  lastTaskId = svgobjId;
                                              }
                                              break;
                                      }                                 

                                  }                                 
                           
                                </script>

                                 <!--Step_1-->
    <rect id="1" onclick='changerect("1")' x="0" y="130" width="135" height="60" fill="rgba(251, 188, 5, 1)" rx="10" ry="10" cursor="hand" />
    <rect x="-5" y="120" width="25" height="25" fill="darkslategray" id="rect1"  rx="15" ry="15" stroke="white" stroke-width="1"/>
    <text fill="white" font-size="12" font-family="Verdana" x="3" y="135">1</text>

    <text fill="white" onclick='changerect("1")' font-size="12" font-family="Verdana" x="8" y="165">&nbsp;&nbsp;Upload Field data</text>
    <line x1="135" y1="145" x2="190" y2="145" stroke="#1689c5" stroke-width="2" marker-end="url(#arrowForward)" />
    <line x1="145" y1="175" x2="200" y2="175" stroke="#1689c5" stroke-width="2" marker-start="url(#arrowBack)" />


    <!--Step_2-->
    <rect id="2" onclick='changerect("2")' x="200" y="130" width="195" height="60" fill="gray" rx="10" ry="10" />
    <rect x="195" y="120" width="25" height="25" fill="darkslategray" id="rect2" rx="15" ry="15" stroke="white" stroke-width="1" />
    <text fill="white" font-size="12" font-family="Verdana" x="204" y="135">2</text>

    <text fill="#ffffff" onclick='changerect("2")' font-size="12" font-family="Verdana" x="208" y="165">&nbsp;&nbsp;Process Field data & Update</text>
    <line x1="395" y1="145" x2="440" y2="145" stroke="#1689c5" stroke-width="2" marker-end="url(#arrowForward)" />
    <line x1="408" y1="175" x2="460" y2="175" stroke="#1689c5" stroke-width="2" marker-start="url(#arrowBack)" />



    <!--Step_3-->

    <rect id="3" onclick='changerect("3")' x="450" y="130" width="100" height="60" fill="gray" rx="10" ry="10" />
    <rect x="445" y="120" width="25" height="25" fill="darkslategray" id="rect3" rx="15" ry="15" stroke="white" stroke-width="1" />
    <text fill="white" font-size="12" font-family="Verdana" x="454" y="135">3</text>


    <text fill="#ffffff" onclick='changerect("3")' font-size="12" font-family="Verdana" x="454" y="165">&nbsp;&nbsp;SLI Review</text>
    <line x1="550" y1="160" x2="590" y2="160" stroke="#1689c5" stroke-width="2" marker-end="url(#arrowForward)" />


    <!--Step_4.1-->
    <rect id="4.1" onclick='changerect("4.1")' x="600" y="130" width="120" height="60" fill="gray" rx="10" ry="10" />
    <rect x="595" y="120" width="25" height="25" fill="darkslategray" id="rect4.1" rx="15" ry="15" stroke="white" stroke-width="1"/>
    <text fill="white" font-size="10" font-family="Verdana" x="600" y="135">4.1</text>


    <text fill="#fffff6" onclick='changerect("4.1")' font-size="12" font-family="Verdana" x="606" y="165">&nbsp;&nbsp;CC&B Process</text>
    <line x1="720" y1="160" x2="780" y2="160" stroke="#1689c5" stroke-width="2" marker-end="url(#arrowForward)" />

    <!--Step_4.2-->
    <rect id="4.2" onclick='changerect("4.2")' x="410" y="0" width="160" height="60" fill="gray" rx="10" ry="10" />
    <rect x="405" y="-5" width="25" height="25" fill="darkslategray" id="rect4.2" rx="15" ry="15" stroke="white" stroke-width="1" />
    <text fill="white" font-size="10" font-family="Verdana" x="408" y="10">4.2</text>
    <text fill="white" onclick='changerect("4.2")' font-size="12" font-family="Verdana" x="415" y="35">&nbsp;&nbsp;Update SL GIS Table</text>
    <!--<line x1="490" y1="60" x2="490" y2="120" stroke="#1689c5" stroke-width="2" marker-end="url(#arrowForward)" />-->
    <line x1="490" y1="70" x2="490" y2="130" stroke="#1689c5" stroke-width="2" marker-start="url(#arrowUp)" />


    <!--Step_5.1-->
    <rect id="5.1" onclick='changerect("5.1")' x="790" y="130" width="130" height="60" fill="gray" rx="10" ry="10" />
    <rect x="785" y="120" width="25" height="25" fill="darkslategray" id="rect5.1" rx="15" ry="15" stroke="white" stroke-width="1" />
    <text fill="white" font-size="10" font-family="Verdana" x="790" y="135">5.1</text>


    <text fill="#fffff6" onclick='changerect("5.1")' font-size="12" font-family="Verdana" x="795" y="160">&nbsp;&nbsp;Load CC&B files</text>
    <text fill="#fffff6" onclick='changerect("5.1")' font-size="12" font-family="Verdana" x="825" y="175">(Dev DB)</text>
    <line x1="920" y1="160" x2="980" y2="160" stroke="#1689c5" stroke-width="2" marker-end="url(#arrowForward)" />

    <!--Step_5.2-->
    <rect id="5.2" onclick='changerect("5.2")' x="580" y="0" width="195" height="60" fill="gray" rx="10" ry="10" />
    <rect x="575" y="-5" width="25" height="25" fill="darkslategray" id="rect5.2" rx="15" ry="15" stroke="white" stroke-width="1" />
    <text fill="white" font-size="10" font-family="Verdana" x="578" y="10">5.2</text>



    <text fill="white" onclick='changerect("5.2")' font-size="12" font-family="Verdana" x="585" y="35">&nbsp;&nbsp;Copy CC&B Files to server</text>

    <polyline points="850,70 850,130 850,70 1240,70 1240,130 " stroke="#1689c5" stroke-width="2" fill="white" fill-opacity="0.01" stroke-opacity="0.8" />
    <line x1="660" y1="70" x2="660" y2="130" stroke="#1689c5" stroke-width="2" marker-start="url(#arrowUp)" />


    <!--Step_6-->
    <rect id="6" onclick='changerect("6")' x="990" y="130" width="120" height="60" fill="gray" rx="10" ry="10" />
    <rect x="985" y="120" width="25" height="25" fill="darkslategray" id="rect6" rx="15" ry="15" stroke="white" stroke-width="1" />
    <text fill="white" font-size="12" font-family="Verdana" x="994" y="135">6</text>



    <text fill="#fffff6" onclick='changerect("6")' font-size="12" font-family="Verdana" x="992" y="160">&nbsp;&nbsp;Generate Report</text>
    <text fill="#fffff6" onclick='changerect("6")' font-size="12" font-family="Verdana" x="1020" y="175">(Dev DB)</text>
    <line x1="1110" y1="160" x2="1180" y2="160" stroke="#1689c5" stroke-width="2" marker-end="url(#arrowForward)" />


    <!--Step_7-->
    <rect id="7" onclick='changerect("7")' x="1190" y="130" width="100" height="60" fill="gray" rx="10" ry="10" />
    <rect x="1185" y="120" width="25" height="25" fill="darkslategray" id="rect7" rx="15" ry="15" stroke="white" stroke-width="1" />
    <text fill="white" font-size="12" font-family="Verdana" x="1194" y="135">7</text>



    <text fill="#fffff6" onclick='changerect("7")' font-size="12" font-family="Verdana" x="1195" y="160">&nbsp;&nbsp;SLI Review </text>
    <text fill="#fffff6" onclick='changerect("7")' font-size="12" font-family="Verdana" x="1200" y="175">(Dev Report)</text>
    <line x1="850" y1="120" x2="850" y2="70" stroke="#1689c5" stroke-width="2" marker-start="url(#arrowDown)" />

    <polyline points="1122,283 1240,283 1240,190 1240,280 " style="fill:white;stroke:#1689c5;stroke-width:2" marker-start="url(#arrowBack)" />

    <!--Step_8-->
    <rect id="8" onclick='changerect("8")' x="990" y="250" width="120" height="60" fill="gray" rx="10" ry="10" />
    <rect x="980" y="240" width="25" height="25" fill="darkslategray" id="rect8" rx="15" ry="15" stroke="white" stroke-width="1" />
    <text fill="white" font-size="12" font-family="Verdana" x="988" y="255">8</text>



    <text fill="#ffffff" onclick='changerect("8")' font-size="12" font-family="Verdana" x="993" y="275">&nbsp;&nbsp;Load CC&B files</text>
    <text fill="#ffffff" onclick='changerect("8")' font-size="12" font-family="Verdana" x="1020" y="295">(Prod DB)</text>
    <line x1="922" y1="283" x2="993" y2="283" stroke="#1689c5" stroke-width="2" marker-start="url(#arrowBack)" />


    <!--Step_9-->
    <rect id="9" onclick='changerect("9")' x="790" y="250" width="125" height="60" fill="gray" rx="10" ry="10"  />
    <rect x="780" y="240" width="25" height="25" fill="darkslategray" id="rect9" rx="15" ry="15" stroke="white" stroke-width="1" />
    <text fill="white" font-size="12" font-family="Verdana" x="788" y="255">9</text>


    <text fill="#ffffff" onclick='changerect("9")' font-size="12" font-family="Verdana" x="795" y="275">&nbsp;&nbsp;Generate Report</text>


    <text fill="#ffffff" onclick='changerect("9")' font-size="12" font-family="Verdana" x="820" y="295">(Prod DB)</text>
    <line x1="530" y1="283" x2="608" y2="283" stroke="#1689c5" stroke-width="2" marker-start="url(#arrowBack)" />

    <!--Step_10-->
    <rect id="10" onclick='changerect("10")' x="600" y="250" width="120" height="60" fill="gray" rx="10" ry="10" />
    <rect x="590" y="240" width="25" height="25" fill="darkslategray" id="rect10" rx="15" ry="15" stroke="white" stroke-width="1" />
    <text fill="white" font-size="12" font-family="Verdana" x="594" y="255">10</text>


    <text fill="#ffffff" onclick='changerect("10")' font-size="12" font-family="Verdana" x="614" y="275">&nbsp;&nbsp;SLI Review</text>
    <text fill="#ffffff" onclick='changerect("10")' font-size="12" font-family="Verdana" x="622" y="295">(Prod Report)</text>
    <line x1="730" y1="283" x2="790" y2="283" stroke="#1689c5" stroke-width="2" marker-start="url(#arrowBack)" />
    <polyline points="1050,350 660,350 660,310" stroke="#1689c5" stroke-width="2" fill-opacity="0.01" stroke-opacity="0.8" />
    <line x1="1050" y1="318" x2="1050" y2="350" stroke="#1689c5" stroke-width="2" marker-start="url(#arrowUp)" />

    <rect id="11" onclick='changerect("11")' fill="gray" rx="10" ry="10" x="320" y="250" width="200" height="60" />
    <rect x="310" y="240" width="25" height="25" fill="darkslategray" id="rect11" rx="15" ry="15" stroke="white" stroke-width="1" />
    <text fill="white" font-size="12" font-family="Verdana" x="314" y="255">11</text>
    <text fill="#ffffff" onclick='changerect("11")' font-size="12" font-family="Verdana" x="325" y="285">&nbsp;&nbsp;Generate Pdf for Map Guide</text>

</svg>

                             <!--   </fieldset>-->
                            </td>
                        </tr>

                    </tbody>
                </table>
            </article>
                </div>
            </div>
            <div id="newJobInitiatediv">
                <div id="divInitiateJob" class="newJobAction">
                    <table style="width: 100%;">
                        <tr>
                            <td style="width:50%">
                                <fieldset>
                                    <legend>Select Streetlight Inventory MDB file(s)<span style="color:red">*</span>:</legend>
                                    <!-- Add the code in a table -->
                                    <table style="width: 100%">
                                        <tr>
                                            <td style="width:90%">
                                                <textarea id="txtPgdbFiles" readonly rows="4" style="border-style: none; border-color: inherit;
                                                    border-width: medium; width: 95%; float: left; height: 100%; font-family: Calibri;
                                                    font-size: 14px;" cols="20" name="S1"></textarea>
                                            </td>
                                            <td style="width:10%">
                                                <!-- Apply the filter for MDB file -->
                                                <input id="fileInputPgdb" type="file" multiple accept=".mdb" style="display: none;" />
                                                <button id="btnPgdbBrws" class="w3-btn w3-blue" onclick="loadFile(this);">
                                                    Browse</button>
                                            </td>
                                           </tr>
                                      
                                    </table>
                                    </fieldset>
                               
                            </td>
                            <td style="width:50%">
                                <fieldset>
                                    <legend>Comments:</legend>
                                    <table style="width: 100%">
                                    <tr>
                                    <td>
                                      <textarea id="txtComments" rows="4" style="border-style: none; border-color: inherit;
                                        border-width: medium; width: 80%; float: left; height: 100%; font-family: Calibri;
                                        font-size: 14px;"> </textarea>
                                    </td>
                                    </tr>
                                    </table>
                                  
                                </fieldset>
                            </td>
                      </tr>
                        <tr>
                            <td style="width:50%">
                                <fieldset>
                                    <legend>Select Job Information document<span style="color:red">*</span>:</legend>
                                    <!-- Add the code in a table -->
                                    <table style="width: 100%">
                                        <tr>
                                            <td style="width:90%">
                                                <textarea id="txtJobInfoFiles" readonly rows="2" style="width: 95%; vertical-align: middle;
                                                    height: 100%; border: none; font-family: Calibri; font-size: 14px;"></textarea>
                                            </td>
                                            <td style="width:10%">
                                                <!-- Apply the filter for DOC and PDF file -->
                                                <input id="fileInputJobInfo" type="file" accept=".doc,.docx,.pdf,.xls,.xlsx" style="display: none;" />
                                                <button id="btnJobInfoBrws" class="w3-btn w3-blue" onclick="loadFile(this);">
                                                    Browse</button>
                                            </td>
                                        </tr>
                                    </table>
                                </fieldset>
                            </td>
                            <td style="width:50%">
                                <fieldset>
                                    <legend>Job Description:</legend>
                                    <table style="width: 100%">
                                    <tr>
                                    <td>
                                    <textarea id="txtJobDesc" rows="2" style="width: 80%; height: 100%; border: none;
                                        font-family: Calibri; font-size: 14px;"> </textarea>
                                    </td></tr></table>
                                    
                                </fieldset>
                            </td>
                        </tr>
                        <tr style="height: 0;">
                            <td colspan="2" align="right">
                                <button class="w3-btn w3-blue" id="btnInitiate">
                                    Initiate</button>
                                <button class="w3-btn w3-amber" id ="btnInitiateCancel" onclick="Clear();">
                                    Cancel</button>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        <div id="History" class="w3-container w3-border initTab">
          
        </div>
        <div id="MainJob" class="initTab">
            <div id="divMJWorkflow" class="w3-container w3-border">
            </div>
            <div id="mainJobInitiatediv">
                <div id="divReview" style="display: none;" class="newJobAction">
                    <table style="width: 55%; margin: 0 auto;">
                        <tr style="height: 0;">
                            <td>
                                <div id="jobid" style="display: inline-block; margin-right: 15%">
                                </div>
                                <div id="desc" style="display: inline-block; margin-right: 30%">
                                </div>
                                <div id="lanid" style="display: inline-block;">
                                </div>                               
                            </td>
                        </tr>
                        <tr style="height: 0;">
                        </tr>
                        <tr style="height: 0;">
                            <td colspan="2">
                                <div>
                                    Comments</div>                                
                                <textarea id="txtReviewComments" rows="5" style="width: 60%; height: 100%; border: none"> </textarea>                               
                            </td>
                        </tr>
                        <tr style="height: 0;">
                            <td colspan="2" align="right">
                                <button style="background-color: rgba(52, 168, 83, 1)" class="w3-btn" id="btnProceed" onclick="reviewJob(this);">
                                    Proceed</button>
                                <button style="background-color: rgba(52, 168, 83, 1)" class="w3-btn" id="btnApprove" onclick= "reviewJob(this);">
                                    Approve</button>
                                <button class="w3-btn w3-blue" id="btnReject" onclick="reviewJob(this);" >
                                    Reject</button>
                                <button class="w3-btn w3-amber" id="btnCancel" onclick="Clear();" style="margin-right: 10%">
                                    Cancel</button>
                            </td>
                        </tr>
                    </table>
                </div>
                <div id="divGISProcess" style="display: none; text-align: center;" class="newJobAction">
                    <label id="lblGISProcess" style="font-family: Calibri; font-size: 28px;">
                    </label>
                </div>
            </div>
        </div>
    </div>
   <script type="text/javascript">
       package_path = window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/'));
       var dojoConfig = {
           async: true,
           parseOnLoad: true,
           packages: [
			{
			    name: "activity",
			    //location: location.pathname.replace(/\/[^\/]+$/, '')
			    location: package_path
			},

            {
                name: 'dgrid',
                location: package_path + "/js/dgrid"
            },
        {
            name: 'dstore',
            location: package_path + "/js/dstore"
        }
            ]
       };

    </script>
   <!-- <script src="//ajax.googleapis.com/ajax/libs/dojo/1.11.2/dojo/dojo.js"></script>-->
      <script src="js/dojo/dojo.js" type="text/javascript"></script>
    <script src="js/onload.js" type="text/javascript"></script>
    <script type="text/javascript" src="js/initiateJob.js"></script>
    <script src="js/reviewJob.js" type="text/javascript"></script>
    
</body>
</html>
