/*Execute the following sde table commands to add the spatial views to the database for Primary Overhead and underground joined with circuit color table.
Privileges to them need to be granted to users via ArcCatalog.
sdetable -o delete -t zpge_spvw_priohconductor  -i sde:oracle11g:/;local=edgisa1d -u edgis -p edgis!A1Di
sdetable -o delete -t zpge_spvw_priugconductor  -i sde:oracle11g:/;local=edgisa1d -u edgis -p edgis!A1Di
sdetable -o create_view -T ZPGE_SPVW_PRIOHCONDUCTOR -t "EDGIS.PRIOHCONDUCTOR, EDGIS.PGE_CIRCUITCOLOR" -c "PRIOHCONDUCTOR.OBJECTID,PRIOHCONDUCTOR.ENABLED,PRIOHCONDUCTOR.GLOBALID,PRIOHCONDUCTOR.CREATIONUSER,PRIOHCONDUCTOR.DATECREATED,PRIOHCONDUCTOR.DATEMODIFIED,PRIOHCONDUCTOR.LASTUSER,PRIOHCONDUCTOR.CONVERSIONID,PRIOHCONDUCTOR.CONVERSIONWORKPACKAGE,PRIOHCONDUCTOR.COMMENTS,PRIOHCONDUCTOR.STATUS,PRIOHCONDUCTOR.INSTALLJOBPREFIX,PRIOHCONDUCTOR.INSTALLJOBYEAR,PRIOHCONDUCTOR.ELECTRICTRACEWEIGHT,PRIOHCONDUCTOR.TRACEABLE,PRIOHCONDUCTOR.CIRCUITID,PRIOHCONDUCTOR.CIRCUITID2,PRIOHCONDUCTOR.CONVCIRCUITID,PRIOHCONDUCTOR.CONVCIRCUITID2,PRIOHCONDUCTOR.FEEDERINFO,PRIOHCONDUCTOR.CEDSANUMBEROFPHASES,PRIOHCONDUCTOR.COUNTY,PRIOHCONDUCTOR.ZIP,PRIOHCONDUCTOR.DMSFEEDERID,PRIOHCONDUCTOR.REPLACEGUID,PRIOHCONDUCTOR.SUBTYPECD,PRIOHCONDUCTOR.LABELTEXT,PRIOHCONDUCTOR.COASTALIDC,PRIOHCONDUCTOR.MEASUREDLENGTH,PRIOHCONDUCTOR.LENGTHSOURCE,PRIOHCONDUCTOR.JACKETTYPE,PRIOHCONDUCTOR.PHASEDESIGNATION,PRIOHCONDUCTOR.PHASINGVERIFIEDSTATUS,PRIOHCONDUCTOR.OPERATINGVOLTAGE,PRIOHCONDUCTOR.CONSTRUCTIONTYPE,PRIOHCONDUCTOR.CEDSALINESECTIONID,PRIOHCONDUCTOR.WINDSPEEDCODE,PRIOHCONDUCTOR.WINDSPEEDRERATEYEAR,PRIOHCONDUCTOR.MAINLINEIDC,PRIOHCONDUCTOR.NEUTRALIDC,PRIOHCONDUCTOR.SERVICEIDC,PRIOHCONDUCTOR.SPACING,PRIOHCONDUCTOR.LABELTEXT2,PRIOHCONDUCTOR.CUSTAGREEMENTGUID,PRIOHCONDUCTOR.CUSTOMEROWNED,PRIOHCONDUCTOR.SHAPE,PRIOHCONDUCTOR.LOCALOFFICEID,PRIOHCONDUCTOR.DISTRICT,PRIOHCONDUCTOR.DIVISION,PRIOHCONDUCTOR.REGION,PRIOHCONDUCTOR.INSTALLJOBNUMBER,PRIOHCONDUCTOR.CITY,PRIOHCONDUCTOR.VERSIONNAME,PGE_CIRCUITCOLOR.COLORCODE" -w "PriOHConductor.CIRCUITID=PGE_CIRCUITCOLOR.CIRCUITID and PriOHConductor.CIRCUITID is not null and PGE_CIRCUITCOLOR.circuitid is not null and PGE_CIRCUITCOLOR.COLORCODE is not null" -i sde:oracle11g:/;local=edgisa1d -u edgis -p edgis!A1Di
sdetable -o create_view -T ZPGE_SPVW_PRIUGCONDUCTOR -t "EDGIS.PRIUGCONDUCTOR, EDGIS.PGE_CIRCUITCOLOR" -c "PRIUGCONDUCTOR.OBJECTID,PRIUGCONDUCTOR.ENABLED,PRIUGCONDUCTOR.GLOBALID,PRIUGCONDUCTOR.CREATIONUSER,PRIUGCONDUCTOR.DATECREATED,PRIUGCONDUCTOR.DATEMODIFIED,PRIUGCONDUCTOR.LASTUSER,PRIUGCONDUCTOR.CONVERSIONID,PRIUGCONDUCTOR.CONVERSIONWORKPACKAGE,PRIUGCONDUCTOR.COMMENTS,PRIUGCONDUCTOR.STATUS,PRIUGCONDUCTOR.INSTALLJOBPREFIX,PRIUGCONDUCTOR.INSTALLJOBYEAR,PRIUGCONDUCTOR.ELECTRICTRACEWEIGHT,PRIUGCONDUCTOR.TRACEABLE,PRIUGCONDUCTOR.CIRCUITID,PRIUGCONDUCTOR.CIRCUITID2,PRIUGCONDUCTOR.CONVCIRCUITID,PRIUGCONDUCTOR.CONVCIRCUITID2,PRIUGCONDUCTOR.FEEDERINFO,PRIUGCONDUCTOR.CEDSANUMBEROFPHASES,PRIUGCONDUCTOR.COUNTY,PRIUGCONDUCTOR.ZIP,PRIUGCONDUCTOR.DMSFEEDERID,PRIUGCONDUCTOR.REPLACEGUID,PRIUGCONDUCTOR.SUBTYPECD,PRIUGCONDUCTOR.LABELTEXT,PRIUGCONDUCTOR.COASTALIDC,PRIUGCONDUCTOR.MEASUREDLENGTH,PRIUGCONDUCTOR.LENGTHSOURCE,PRIUGCONDUCTOR.JACKETTYPE,PRIUGCONDUCTOR.PHASEDESIGNATION,PRIUGCONDUCTOR.PHASINGVERIFIEDSTATUS,PRIUGCONDUCTOR.OPERATINGVOLTAGE,PRIUGCONDUCTOR.CABLECOUNT,PRIUGCONDUCTOR.CONSTRUCTIONTYPE,PRIUGCONDUCTOR.BACKFILLMATERIAL,PRIUGCONDUCTOR.CEDSALINESECTIONID,PRIUGCONDUCTOR.JOINTTRENCHIDC,PRIUGCONDUCTOR.MAINLINEIDC,PRIUGCONDUCTOR.NEUTRALIDC,PRIUGCONDUCTOR.SERVICEIDC,PRIUGCONDUCTOR.SOILCONDITION,PRIUGCONDUCTOR.UGASTATUS,PRIUGCONDUCTOR.DIRECTBURYIDC,PRIUGCONDUCTOR.LABELTEXT2,PRIUGCONDUCTOR.UGASTATUSVERIFIEDBY,PRIUGCONDUCTOR.UGASTATUSVERIFIEDDATE,PRIUGCONDUCTOR.CUSTAGREEMENTGUID,PRIUGCONDUCTOR.CUSTOMEROWNED,PRIUGCONDUCTOR.SHAPE,PRIUGCONDUCTOR.LOCALOFFICEID,PRIUGCONDUCTOR.DISTRICT,PRIUGCONDUCTOR.DIVISION,PRIUGCONDUCTOR.REGION,PRIUGCONDUCTOR.INSTALLJOBNUMBER,PRIUGCONDUCTOR.DAILYLOADFACTOR,PRIUGCONDUCTOR.CITY,PRIUGCONDUCTOR.VERSIONNAME,PGE_CIRCUITCOLOR.COLORCODE" -w "PriUGConductor.CIRCUITID=PGE_CIRCUITCOLOR.CIRCUITID and PriUGConductor.CIRCUITID is not null and PGE_CIRCUITCOLOR.circuitid is not null and PGE_CIRCUITCOLOR.COLORCODE is not null" -i sde:oracle11g:/;local=edgisa1d -u edgis -p edgis!A1Di
*/

/*Alter the views created from above to handle duplicate circuit IDs.  We will take the Min(colorcode).*/
CREATE OR REPLACE VIEW ZPGE_SPVW_PRIOHCONDUCTOR AS SELECT PRIOHCONDUCTOR.OBJECTID,
  PRIOHCONDUCTOR.ENABLED,
  PRIOHCONDUCTOR.GLOBALID,
  PRIOHCONDUCTOR.CREATIONUSER,
  PRIOHCONDUCTOR.DATECREATED,
  PRIOHCONDUCTOR.DATEMODIFIED,
  PRIOHCONDUCTOR.LASTUSER,
  PRIOHCONDUCTOR.CONVERSIONID,
  PRIOHCONDUCTOR.CONVERSIONWORKPACKAGE,
  PRIOHCONDUCTOR.COMMENTS,
  PRIOHCONDUCTOR.STATUS,
  PRIOHCONDUCTOR.INSTALLJOBPREFIX,
  PRIOHCONDUCTOR.INSTALLJOBYEAR,
  PRIOHCONDUCTOR.ELECTRICTRACEWEIGHT,
  PRIOHCONDUCTOR.TRACEABLE,
  PRIOHCONDUCTOR.CIRCUITID,
  PRIOHCONDUCTOR.CIRCUITID2,
  PRIOHCONDUCTOR.CONVCIRCUITID,
  PRIOHCONDUCTOR.CONVCIRCUITID2,
  PRIOHCONDUCTOR.FEEDERINFO,
  PRIOHCONDUCTOR.CEDSANUMBEROFPHASES,
  PRIOHCONDUCTOR.COUNTY,
  PRIOHCONDUCTOR.ZIP,
  PRIOHCONDUCTOR.DMSFEEDERID,
  PRIOHCONDUCTOR.REPLACEGUID,
  PRIOHCONDUCTOR.SUBTYPECD,
  PRIOHCONDUCTOR.LABELTEXT,
  PRIOHCONDUCTOR.COASTALIDC,
  PRIOHCONDUCTOR.MEASUREDLENGTH,
  PRIOHCONDUCTOR.LENGTHSOURCE,
  PRIOHCONDUCTOR.JACKETTYPE,
  PRIOHCONDUCTOR.PHASEDESIGNATION,
  PRIOHCONDUCTOR.PHASINGVERIFIEDSTATUS,
  PRIOHCONDUCTOR.OPERATINGVOLTAGE,
  PRIOHCONDUCTOR.CONSTRUCTIONTYPE,
  PRIOHCONDUCTOR.CEDSALINESECTIONID,
  PRIOHCONDUCTOR.WINDSPEEDCODE,
  PRIOHCONDUCTOR.WINDSPEEDRERATEYEAR,
  PRIOHCONDUCTOR.MAINLINEIDC,
  PRIOHCONDUCTOR.NEUTRALIDC,
  PRIOHCONDUCTOR.SERVICEIDC,
  PRIOHCONDUCTOR.SPACING,
  PRIOHCONDUCTOR.LABELTEXT2,
  PRIOHCONDUCTOR.CUSTAGREEMENTGUID,
  PRIOHCONDUCTOR.CUSTOMEROWNED,
  PRIOHCONDUCTOR.SHAPE,
  PRIOHCONDUCTOR.LOCALOFFICEID,
  PRIOHCONDUCTOR.DISTRICT,
 PRIOHCONDUCTOR.DIVISION,
  PRIOHCONDUCTOR.REGION,
  PRIOHCONDUCTOR.INSTALLJOBNUMBER,
  PRIOHCONDUCTOR.CITY,
  PRIOHCONDUCTOR.VERSIONNAME,
  PGE_CIRCUITCOLOR.COLORCODE
FROM EDGIS.PRIOHCONDUCTOR
LEFT OUTER JOIN
  (SELECT MIN(colorcode) as colorcode,
    circuitid
  FROM pge_circuitcolor
  GROUP BY circuitid
  ) pge_circuitcolor
ON PriOHConductor.CIRCUITID=PGE_CIRCUITCOLOR.CIRCUITID;

CREATE OR REPLACE VIEW ZPGE_SPVW_PRIUGCONDUCTOR AS SELECT PRIUGCONDUCTOR.OBJECTID,
    PRIUGCONDUCTOR.ENABLED,
    PRIUGCONDUCTOR.GLOBALID,
    PRIUGCONDUCTOR.CREATIONUSER,
    PRIUGCONDUCTOR.DATECREATED,
    PRIUGCONDUCTOR.DATEMODIFIED,
    PRIUGCONDUCTOR.LASTUSER,
    PRIUGCONDUCTOR.CONVERSIONID,
    PRIUGCONDUCTOR.CONVERSIONWORKPACKAGE,
    PRIUGCONDUCTOR.COMMENTS,
    PRIUGCONDUCTOR.STATUS,
    PRIUGCONDUCTOR.INSTALLJOBPREFIX,
    PRIUGCONDUCTOR.INSTALLJOBYEAR,
    PRIUGCONDUCTOR.ELECTRICTRACEWEIGHT,
    PRIUGCONDUCTOR.TRACEABLE,
    PRIUGCONDUCTOR.CIRCUITID,
    PRIUGCONDUCTOR.CIRCUITID2,
    PRIUGCONDUCTOR.CONVCIRCUITID,
    PRIUGCONDUCTOR.CONVCIRCUITID2,
    PRIUGCONDUCTOR.FEEDERINFO,
    PRIUGCONDUCTOR.CEDSANUMBEROFPHASES,
    PRIUGCONDUCTOR.COUNTY,
    PRIUGCONDUCTOR.ZIP,
    PRIUGCONDUCTOR.DMSFEEDERID,
    PRIUGCONDUCTOR.REPLACEGUID,
    PRIUGCONDUCTOR.SUBTYPECD,
    PRIUGCONDUCTOR.LABELTEXT,
    PRIUGCONDUCTOR.COASTALIDC,
    PRIUGCONDUCTOR.MEASUREDLENGTH,
    PRIUGCONDUCTOR.LENGTHSOURCE,
    PRIUGCONDUCTOR.JACKETTYPE,
    PRIUGCONDUCTOR.PHASEDESIGNATION,
    PRIUGCONDUCTOR.PHASINGVERIFIEDSTATUS,
    PRIUGCONDUCTOR.OPERATINGVOLTAGE,
    PRIUGCONDUCTOR.CABLECOUNT,
    PRIUGCONDUCTOR.CONSTRUCTIONTYPE,
    PRIUGCONDUCTOR.BACKFILLMATERIAL,
    PRIUGCONDUCTOR.CEDSALINESECTIONID,
    PRIUGCONDUCTOR.JOINTTRENCHIDC,
    PRIUGCONDUCTOR.MAINLINEIDC,
    PRIUGCONDUCTOR.NEUTRALIDC,
    PRIUGCONDUCTOR.SERVICEIDC,
    PRIUGCONDUCTOR.SOILCONDITION,
    PRIUGCONDUCTOR.UGASTATUS,
    PRIUGCONDUCTOR.DIRECTBURYIDC,
    PRIUGCONDUCTOR.LABELTEXT2,
    PRIUGCONDUCTOR.UGASTATUSVERIFIEDBY,
    PRIUGCONDUCTOR.UGASTATUSVERIFIEDDATE,
    PRIUGCONDUCTOR.CUSTAGREEMENTGUID,
    PRIUGCONDUCTOR.CUSTOMEROWNED,
    PRIUGCONDUCTOR.SHAPE,
    PRIUGCONDUCTOR.LOCALOFFICEID,
    PRIUGCONDUCTOR.DISTRICT,
    PRIUGCONDUCTOR.DIVISION,
    PRIUGCONDUCTOR.REGION,
    PRIUGCONDUCTOR.INSTALLJOBNUMBER,
    PRIUGCONDUCTOR.DAILYLOADFACTOR,
    PRIUGCONDUCTOR.CITY,
    PRIUGCONDUCTOR.VERSIONNAME ,
    PGE_CIRCUITCOLOR.COLORCODE
  FROM priugconductor
  LEFT OUTER JOIN
    (SELECT MIN(colorcode) AS colorcode,
      circuitid
    FROM pge_circuitcolor
    GROUP BY circuitid
    ) pge_circuitcolor
  ON priugconductor.circuitid=pge_circuitcolor.CIRCUITID
  ;
